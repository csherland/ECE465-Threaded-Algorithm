" 
"	Christian Sherland
"	    .vimrc 
"
"

" Handle some basic stuff to enable plugins
set nocompatible
syntax on
filetype off

" Setting up Vundle - the vim plugin bundler
    let iCanHazVundle=1
    let vundle_readme=expand('~/.vim/bundle/vundle/README.md')
    if !filereadable(vundle_readme)
        echo "Installing Vundle.."
        echo ""
        silent !mkdir -p ~/.vim/bundle
        silent !git clone https://github.com/gmarik/vundle ~/.vim/bundle/vundle
        let iCanHazVundle=0
    endif

set rtp+=~/.vim/bundle/vundle/
call vundle#rc()

" Bundles
Bundle 'tpope/vim-fugitive'
Bundle 'scrooloose/nerdtree'
Bundle 'scrooloose/nerdcommenter'
Bundle 'scrooloose/syntastic'
Bundle 'altercation/vim-colors-solarized'
Bundle 'bling/vim-airline'
Bundle 'bling/vim-bufferline'
Bundle 'Yggdroot/indentLine'

"...All your other bundles...
if iCanHazVundle == 0
    echo "Installing Bundles, please ignore key map error messages"
    echo ""
    :BundleInstall
endif

filetype plugin indent on


" Toggle syntastic error window
function! ToggleErrors()
    let old_last_winnr = winnr('$')
    lclose
    if old_last_winnr == winnr('$')
        " Nothing was closed, open syntastic error location panel
        Errors
    endif
endfunction

nnoremap <silent> <C-e> :<C-u>call ToggleErrors()<CR>
nnoremap <silent> <C-e> :<CR>
nmap <silent> <leader>stm :SyntasticToggleMode<CR> 
let g:syntastic_enable_signs=1

" Better color stuff
" set background=dark
colorscheme solarized

" Map leader to comma
let mapleader=","

" Fix wrapping behavior when moving
nmap j gj
nmap k gk

" move to beginning/end of line
nnoremap B ^
nnoremap E $

" $/^ doesn't do anything
nnoremap $ <nop>
nnoremap ^ <nop>

" Moving between buffers
nmap <C-n> :bnext<CR>
nmap <C-p> :bprev<CR>

" Mappings for vim command line actions
cnoremap <C-a> <Home>
cnoremap <C-b> <Left>
cnoremap <C-f> <Right>
cnoremap <C-d> <Delete>
cnoremap <M-b> <S-left>
cnoremap <M-f> <S-right>
cnoremap <M-d> <S-right><Delete>
cnoremap <Esc>b <S-left>
cnoremap <Esc>f <S-right>
cnoremap <Esc>d <S-right><Delete>
cnoremap <C-g> <C-c>

" Options dealing with search
set incsearch
set ignorecase
set smartcase
set hlsearch

" Highlight current line
set cursorline

" Clear the search buffer
nmap <silent> ,/ :nohlsearch<CR>

" Show command in bottom bar
set showcmd

" Visual autocomplete for command menu
set wildmenu            

" Line numbers
set number

" Some editing preferences (tabs,  etc)
set expandtab
set tabstop=4
set shiftwidth=4
set backspace=indent,eol,start
set autoindent
set copyindent
set showmatch "show matching {}
set smarttab

" Set information on history
set history=1000
set undolevels=1000
set wildignore=*.swp,*.bak,*.pyc,*.class

" Terminal setting
set title
set visualbell
set noerrorbells

" Dont allow vim to make backups
set nobackup
set noswapfile

" This will save a lot of time
nnoremap ; :

" Enable the use of the mouse
set mouse=a

" Set the terminals title
set title

" Forgot to sudo? No problem!
cmap w!! w !sudo tee % >/dev/null

" Set up some things for NERDTree
nmap <silent> <leader>nt :NERDTree<CR>
nmap <silent> <leader>ntc :NERDTreeClose<CR> 
nmap <silent> <leader>stm :SyntasticToggleMode<CR> 


" Quickly edit/reload the vimrc file
nmap <silent> <leader>ev :e $MYVIMRC<CR>
nmap <silent> <leader>sv :so $MYVIMRC<CR>

" Set powerline up
set laststatus=2
set encoding=utf-8
let g:Powerline_symbols = 'fancy'

" Airline
let g:airline#extensions#tabline#enabled = 1
let g:airline#extensions#tabline#show_buffers = 1
let g:airline_powerline_fonts = 1
let g:airline#extensions#whitespace#enabled = 0
let g:airline#extensions#bufferline#enabled = 0

